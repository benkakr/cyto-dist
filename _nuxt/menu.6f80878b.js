import{y as F,w as N,h as L,o as d,c as B,u as K,l as x,H as P,t as w,p as j,N as D,a as v,v as _,b as E,_ as C,O as U}from"./use-outside-click.fb28adfb.js";import{u as V,x as q,a as I}from"./use-tracked-pointer.ef35251b.js";import{p as H}from"./use-tree-walker.d3fc51a3.js";import{b as Q}from"./use-resolve-button-type.0736f1ce.js";import{d as T,r as M,c as R,R as Y,Y as A,$ as z,_ as J,z as y,N as W}from"./entry.f0e78823.js";var X=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(X||{}),Z=(n=>(n[n.Pointer=0]="Pointer",n[n.Other=1]="Other",n))(Z||{});function G(n){requestAnimationFrame(()=>requestAnimationFrame(n))}let O=Symbol("MenuContext");function k(n){let g=W(O,null);if(g===null){let S=new Error(`<${n} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(S,k),S}return g}let le=T({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(n,{slots:g,attrs:S}){let b=M(1),e=M(null),c=M(null),i=M([]),m=M(""),s=M(null),u=M(1);function t(l=r=>r){let r=s.value!==null?i.value[s.value]:null,a=U(l(i.value.slice()),f=>d(f.dataRef.domRef)),o=r?a.indexOf(r):null;return o===-1&&(o=null),{items:a,activeItemIndex:o}}let p={menuState:b,buttonRef:e,itemsRef:c,items:i,searchQuery:m,activeItemIndex:s,activationTrigger:u,closeMenu:()=>{b.value=1,s.value=null},openMenu:()=>b.value=0,goToItem(l,r,a){let o=t(),f=q(l===I.Specific?{focus:I.Specific,id:r}:{focus:l},{resolveItems:()=>o.items,resolveActiveIndex:()=>o.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.disabled});m.value="",s.value=f,u.value=a??1,i.value=o.items},search(l){let r=m.value!==""?0:1;m.value+=l.toLowerCase();let a=(s.value!==null?i.value.slice(s.value+r).concat(i.value.slice(0,s.value+r)):i.value).find(f=>f.dataRef.textValue.startsWith(m.value)&&!f.dataRef.disabled),o=a?i.value.indexOf(a):-1;o===-1||o===s.value||(s.value=o,u.value=1)},clearSearch(){m.value=""},registerItem(l,r){let a=t(o=>[...o,{id:l,dataRef:r}]);i.value=a.items,s.value=a.activeItemIndex,u.value=1},unregisterItem(l){let r=t(a=>{let o=a.findIndex(f=>f.id===l);return o!==-1&&a.splice(o,1),a});i.value=r.items,s.value=r.activeItemIndex,u.value=1}};return F([e,c],(l,r)=>{var a;p.closeMenu(),N(r,L.Loose)||(l.preventDefault(),(a=d(e))==null||a.focus())},R(()=>b.value===0)),Y(O,p),B(R(()=>K(b.value,{[0]:x.Open,[1]:x.Closed}))),()=>{let l={open:b.value===0,close:p.closeMenu};return P({ourProps:{},theirProps:n,slot:l,slots:g,attrs:S,name:"Menu"})}}}),oe=T({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-menu-button-${w()}`}},setup(n,{attrs:g,slots:S,expose:b}){let e=k("MenuButton");b({el:e.buttonRef,$el:e.buttonRef});function c(u){switch(u.key){case v.Space:case v.Enter:case v.ArrowDown:u.preventDefault(),u.stopPropagation(),e.openMenu(),y(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.First)});break;case v.ArrowUp:u.preventDefault(),u.stopPropagation(),e.openMenu(),y(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.Last)});break}}function i(u){switch(u.key){case v.Space:u.preventDefault();break}}function m(u){n.disabled||(e.menuState.value===0?(e.closeMenu(),y(()=>{var t;return(t=d(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(u.preventDefault(),e.openMenu(),G(()=>{var t;return(t=d(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let s=Q(R(()=>({as:n.as,type:g.type})),e.buttonRef);return()=>{var u;let t={open:e.menuState.value===0},{id:p,...l}=n,r={ref:e.buttonRef,id:p,type:s.value,"aria-haspopup":"menu","aria-controls":(u=d(e.itemsRef))==null?void 0:u.id,"aria-expanded":n.disabled?void 0:e.menuState.value===0,onKeydown:c,onKeyup:i,onClick:m};return P({ourProps:r,theirProps:l,slot:t,attrs:g,slots:S,name:"MenuButton"})}}}),ue=T({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-menu-items-${w()}`}},setup(n,{attrs:g,slots:S,expose:b}){let e=k("MenuItems"),c=M(null);b({el:e.itemsRef,$el:e.itemsRef}),H({container:R(()=>d(e.itemsRef)),enabled:R(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function i(t){var p;switch(c.value&&clearTimeout(c.value),t.key){case v.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case v.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let l=e.items.value[e.activeItemIndex.value];(p=d(l.dataRef.domRef))==null||p.click()}e.closeMenu(),C(d(e.buttonRef));break;case v.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Next);case v.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Previous);case v.Home:case v.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.First);case v.End:case v.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Last);case v.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),y(()=>{var l;return(l=d(e.buttonRef))==null?void 0:l.focus({preventScroll:!0})});break;case v.Tab:t.preventDefault(),t.stopPropagation(),e.closeMenu(),y(()=>_(d(e.buttonRef),t.shiftKey?E.Previous:E.Next));break;default:t.key.length===1&&(e.search(t.key),c.value=setTimeout(()=>e.clearSearch(),350));break}}function m(t){switch(t.key){case v.Space:t.preventDefault();break}}let s=j(),u=R(()=>s!==null?(s.value&x.Open)===x.Open:e.menuState.value===0);return()=>{var t,p;let l={open:e.menuState.value===0},{id:r,...a}=n,o={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(p=d(e.buttonRef))==null?void 0:p.id,id:r,onKeydown:i,onKeyup:m,role:"menu",tabIndex:0,ref:e.itemsRef};return P({ourProps:o,theirProps:a,slot:l,attrs:g,slots:S,features:D.RenderStrategy|D.Static,visible:u.value,name:"MenuItems"})}}}),re=T({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-menu-item-${w()}`}},setup(n,{slots:g,attrs:S,expose:b}){let e=k("MenuItem"),c=M(null);b({el:c,$el:c});let i=R(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===n.id:!1),m=R(()=>({disabled:n.disabled,textValue:"",domRef:c}));A(()=>{var a,o;let f=(o=(a=d(c))==null?void 0:a.textContent)==null?void 0:o.toLowerCase().trim();f!==void 0&&(m.value.textValue=f)}),A(()=>e.registerItem(n.id,m)),z(()=>e.unregisterItem(n.id)),J(()=>{e.menuState.value===0&&i.value&&e.activationTrigger.value!==0&&y(()=>{var a,o;return(o=(a=d(c))==null?void 0:a.scrollIntoView)==null?void 0:o.call(a,{block:"nearest"})})});function s(a){if(n.disabled)return a.preventDefault();e.closeMenu(),C(d(e.buttonRef))}function u(){if(n.disabled)return e.goToItem(I.Nothing);e.goToItem(I.Specific,n.id)}let t=V();function p(a){t.update(a)}function l(a){t.wasMoved(a)&&(n.disabled||i.value||e.goToItem(I.Specific,n.id,0))}function r(a){t.wasMoved(a)&&(n.disabled||i.value&&e.goToItem(I.Nothing))}return()=>{let{disabled:a}=n,o={active:i.value,disabled:a,close:e.closeMenu},{id:f,...h}=n;return P({ourProps:{id:f,ref:c,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,disabled:void 0,onClick:s,onFocus:u,onPointerenter:p,onMouseenter:p,onPointermove:l,onMousemove:l,onPointerleave:r,onMouseleave:r},theirProps:{...S,...h},slot:o,attrs:S,slots:g,name:"MenuItem"})}}});export{re as M,oe as S,ue as b,le as g};
