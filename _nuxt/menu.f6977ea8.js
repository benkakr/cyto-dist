import{o as d,y as N,w as B,h as K,c as j,u as _,l as x,H as P,t as D,p as U,N as E,a as p,v as V,b as A,_ as O,O as H}from"./use-outside-click.2d4f8df8.js";import{p as q,u as Q,x as Y,a as S}from"./use-tracked-pointer.baeceed5.js";import{r as M,Y as k,_ as F,d as T,c as y,R as z,$ as J,z as R,N as W}from"./entry.208f3c12.js";function C(a,c){if(a)return a;let s=c??"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function X(a,c){let s=M(C(a.value.type,a.value.as));return k(()=>{s.value=C(a.value.type,a.value.as)}),F(()=>{var m;s.value||d(c)&&d(c)instanceof HTMLButtonElement&&!((m=d(c))!=null&&m.hasAttribute("type"))&&(s.value="button")}),s}var Z=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(Z||{}),G=(a=>(a[a.Pointer=0]="Pointer",a[a.Other=1]="Other",a))(G||{});function $(a){requestAnimationFrame(()=>requestAnimationFrame(a))}let L=Symbol("MenuContext");function w(a){let c=W(L,null);if(c===null){let s=new Error(`<${a} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,w),s}return c}let ne=T({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(a,{slots:c,attrs:s}){let m=M(1),e=M(null),f=M(null),i=M([]),I=M(""),v=M(null),o=M(1);function t(l=r=>r){let r=v.value!==null?i.value[v.value]:null,n=H(l(i.value.slice()),g=>d(g.dataRef.domRef)),u=r?n.indexOf(r):null;return u===-1&&(u=null),{items:n,activeItemIndex:u}}let b={menuState:m,buttonRef:e,itemsRef:f,items:i,searchQuery:I,activeItemIndex:v,activationTrigger:o,closeMenu:()=>{m.value=1,v.value=null},openMenu:()=>m.value=0,goToItem(l,r,n){let u=t(),g=Y(l===S.Specific?{focus:S.Specific,id:r}:{focus:l},{resolveItems:()=>u.items,resolveActiveIndex:()=>u.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.disabled});I.value="",v.value=g,o.value=n??1,i.value=u.items},search(l){let r=I.value!==""?0:1;I.value+=l.toLowerCase();let n=(v.value!==null?i.value.slice(v.value+r).concat(i.value.slice(0,v.value+r)):i.value).find(g=>g.dataRef.textValue.startsWith(I.value)&&!g.dataRef.disabled),u=n?i.value.indexOf(n):-1;u===-1||u===v.value||(v.value=u,o.value=1)},clearSearch(){I.value=""},registerItem(l,r){let n=t(u=>[...u,{id:l,dataRef:r}]);i.value=n.items,v.value=n.activeItemIndex,o.value=1},unregisterItem(l){let r=t(n=>{let u=n.findIndex(g=>g.id===l);return u!==-1&&n.splice(u,1),n});i.value=r.items,v.value=r.activeItemIndex,o.value=1}};return N([e,f],(l,r)=>{var n;b.closeMenu(),B(r,K.Loose)||(l.preventDefault(),(n=d(e))==null||n.focus())},y(()=>m.value===0)),z(L,b),j(y(()=>_(m.value,{[0]:x.Open,[1]:x.Closed}))),()=>{let l={open:m.value===0,close:b.closeMenu};return P({ourProps:{},theirProps:a,slot:l,slots:c,attrs:s,name:"Menu"})}}}),le=T({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-menu-button-${D()}`}},setup(a,{attrs:c,slots:s,expose:m}){let e=w("MenuButton");m({el:e.buttonRef,$el:e.buttonRef});function f(o){switch(o.key){case p.Space:case p.Enter:case p.ArrowDown:o.preventDefault(),o.stopPropagation(),e.openMenu(),R(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(S.First)});break;case p.ArrowUp:o.preventDefault(),o.stopPropagation(),e.openMenu(),R(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(S.Last)});break}}function i(o){switch(o.key){case p.Space:o.preventDefault();break}}function I(o){a.disabled||(e.menuState.value===0?(e.closeMenu(),R(()=>{var t;return(t=d(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(o.preventDefault(),e.openMenu(),$(()=>{var t;return(t=d(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let v=X(y(()=>({as:a.as,type:c.type})),e.buttonRef);return()=>{var o;let t={open:e.menuState.value===0},{id:b,...l}=a,r={ref:e.buttonRef,id:b,type:v.value,"aria-haspopup":"menu","aria-controls":(o=d(e.itemsRef))==null?void 0:o.id,"aria-expanded":a.disabled?void 0:e.menuState.value===0,onKeydown:f,onKeyup:i,onClick:I};return P({ourProps:r,theirProps:l,slot:t,attrs:c,slots:s,name:"MenuButton"})}}}),ue=T({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-menu-items-${D()}`}},setup(a,{attrs:c,slots:s,expose:m}){let e=w("MenuItems"),f=M(null);m({el:e.itemsRef,$el:e.itemsRef}),q({container:y(()=>d(e.itemsRef)),enabled:y(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function i(t){var b;switch(f.value&&clearTimeout(f.value),t.key){case p.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case p.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let l=e.items.value[e.activeItemIndex.value];(b=d(l.dataRef.domRef))==null||b.click()}e.closeMenu(),O(d(e.buttonRef));break;case p.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(S.Next);case p.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(S.Previous);case p.Home:case p.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(S.First);case p.End:case p.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(S.Last);case p.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),R(()=>{var l;return(l=d(e.buttonRef))==null?void 0:l.focus({preventScroll:!0})});break;case p.Tab:t.preventDefault(),t.stopPropagation(),e.closeMenu(),R(()=>V(d(e.buttonRef),t.shiftKey?A.Previous:A.Next));break;default:t.key.length===1&&(e.search(t.key),f.value=setTimeout(()=>e.clearSearch(),350));break}}function I(t){switch(t.key){case p.Space:t.preventDefault();break}}let v=U(),o=y(()=>v!==null?(v.value&x.Open)===x.Open:e.menuState.value===0);return()=>{var t,b;let l={open:e.menuState.value===0},{id:r,...n}=a,u={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(b=d(e.buttonRef))==null?void 0:b.id,id:r,onKeydown:i,onKeyup:I,role:"menu",tabIndex:0,ref:e.itemsRef};return P({ourProps:u,theirProps:n,slot:l,attrs:c,slots:s,features:E.RenderStrategy|E.Static,visible:o.value,name:"MenuItems"})}}}),oe=T({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-menu-item-${D()}`}},setup(a,{slots:c,attrs:s,expose:m}){let e=w("MenuItem"),f=M(null);m({el:f,$el:f});let i=y(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===a.id:!1),I=y(()=>({disabled:a.disabled,textValue:"",domRef:f}));k(()=>{var n,u;let g=(u=(n=d(f))==null?void 0:n.textContent)==null?void 0:u.toLowerCase().trim();g!==void 0&&(I.value.textValue=g)}),k(()=>e.registerItem(a.id,I)),J(()=>e.unregisterItem(a.id)),F(()=>{e.menuState.value===0&&i.value&&e.activationTrigger.value!==0&&R(()=>{var n,u;return(u=(n=d(f))==null?void 0:n.scrollIntoView)==null?void 0:u.call(n,{block:"nearest"})})});function v(n){if(a.disabled)return n.preventDefault();e.closeMenu(),O(d(e.buttonRef))}function o(){if(a.disabled)return e.goToItem(S.Nothing);e.goToItem(S.Specific,a.id)}let t=Q();function b(n){t.update(n)}function l(n){t.wasMoved(n)&&(a.disabled||i.value||e.goToItem(S.Specific,a.id,0))}function r(n){t.wasMoved(n)&&(a.disabled||i.value&&e.goToItem(S.Nothing))}return()=>{let{disabled:n}=a,u={active:i.value,disabled:n,close:e.closeMenu},{id:g,...h}=a;return P({ourProps:{id:g,ref:f,role:"menuitem",tabIndex:n===!0?void 0:-1,"aria-disabled":n===!0?!0:void 0,disabled:void 0,onClick:v,onFocus:o,onPointerenter:b,onMouseenter:b,onPointermove:l,onMousemove:l,onPointerleave:r,onMouseleave:r},theirProps:{...s,...h},slot:u,attrs:s,slots:c,name:"MenuItem"})}}});export{oe as M,le as S,X as a,ue as b,ne as g};
